### A Report Tempate ###
#The XLSX report to use#
workbook_name: 'ApplicationResourceUsage.xlsx'
worksheets:
  #The worksheet/tab to create the report in#
  - worksheet_name: 'ApplicationResourceUsage'
    worksheet_type: 'records'
    attributes:
      #If you want to freeze panes#
      freeze_panes:
          row: 1
      #If you want to special format columns#
      xlsx_column_formats:
          1:
              column_type: datetime
              strptime: '%Y-%m-%d %H:%M:%S'
              format: {'num_format': 'mm/dd/yyyy hh:mm:ss'}
      #The SQLite Query to run#
      sql_query: |
          SELECT
            AppIdTable.IdBlob AS ApplicationName,
            ApplicationResourceUsageProvider.TimeStamp,
            UserIdTable.IdBlob AS UserId,
            ApplicationResourceUsageProvider.ForegroundBytesRead,
            ApplicationResourceUsageProvider.ForegroundBytesWritten,
            ApplicationResourceUsageProvider.ForegroundNumReadOperations,
            ApplicationResourceUsageProvider.ForegroundNumWriteOperations,
            ApplicationResourceUsageProvider.ForegroundNumberOfFlushes,
            ApplicationResourceUsageProvider.BackgroundBytesRead,
            ApplicationResourceUsageProvider.BackgroundBytesWritten,
            ApplicationResourceUsageProvider.BackgroundNumReadOperations,
            ApplicationResourceUsageProvider.BackgroundNumWriteOperations,
            ApplicationResourceUsageProvider.BackgroundNumberOfFlushes
          FROM
            ApplicationResourceUsageProvider
          INNER JOIN SruDbIdMapTable AS AppIdTable ON ApplicationResourceUsageProvider.AppId = AppIdTable.IdIndex
          INNER JOIN SruDbIdMapTable AS UserIdTable ON ApplicationResourceUsageProvider.UserId = UserIdTable.IdIndex
          ORDER BY ApplicationName
