### A Report Tempate ###
#The XLSX report to use#
workbook_name: 'ForegroundAppUsage.xlsx'
worksheets:
  #The worksheet/tab to create the report in#
  - worksheet_name: 'ForegroundAppUsage'
    worksheet_type: 'records'
    attributes:
      #If you want to freeze panes#
      freeze_panes:
          row: 1
      #If you want to special format columns#
      xlsx_column_formats:
          0:
              column_type: datetime
              strptime: '%Y-%m-%d %H:%M:%S'
              format: {'num_format': 'mm/dd/yyyy hh:mm:ss'}
      #The SQLite Query to run#
      sql_query: |
          SELECT
          /* ForegroundAppUsage */
          ApplicationResourceUsageProvider.TimeStamp,
          ApplicationResourceUsageProvider.AppId,
          sum(ApplicationResourceUsageProvider.ForegroundCycleTime) AS FgdCyclTime,
          sum(ApplicationResourceUsageProvider.ForegroundBytesRead) AS FgdBytesRd,
          sum(ApplicationResourceUsageProvider.ForegroundBytesWritten) AS FgdBytesWrit,
          sum(ApplicationResourceUsageProvider.ForegroundNumReadOperations) AS FgdNumRdOper,
          sum(ApplicationResourceUsageProvider.ForegroundNumWriteOperations) AS FgdNumWritOper,
          BasenameN(SruDbIdMapTable.IdBlob,2) AS Name,
          SruDbIdMapTable.IdBlob AS Fullpath
          /* SruDbIdMapTable.IdIndex  */
          FROM ApplicationResourceUsageProvider
          LEFT JOIN SruDbIdMapTable ON
          ApplicationResourceUsageProvider.AppId = SruDbIdMapTable.IdIndex
          GROUP BY ApplicationResourceUsageProvider.AppId HAVING FgdCyclTime != 0
          ORDER BY FgdCyclTime DESC;
  - worksheet_name: 'PivotTest'
    worksheet_type: 'chart'
    attributes:
      insert_cell: 'A1'
      chart:
        type: 'column'
        subtype: 'stacked'
      legend:
        position: 'left'
      size:
        x_scale: 50
        y_scale: 2
      series:
        - name: 'ForegroundAppUsage!$D$1'
          categories: 'ForegroundAppUsage!$H$1:$H${ForegroundAppUsage[EndRow]}'
          values: '=(ForegroundAppUsage!$D$1:$D${ForegroundAppUsage[EndRow]})'
        - name: 'ForegroundAppUsage!$E$1'
          categories: 'ForegroundAppUsage!$H$1:$H${ForegroundAppUsage[EndRow]}'
          values: '=(ForegroundAppUsage!$E$1:$E${ForegroundAppUsage[EndRow]})'
